library(dplyr)
murders = subset(crime, offense="murder")
houston = get_stamenmap(bbox=as.numeric(geocode_OSM("Houston")$bbox), zoom=11, maptype="toner")
ggmap(houston)
ggmap(houston, base_layer = ggplot(data=murders, aes(x=lon, y=lat)))+geom_point(color="red", size=3, alpha=0.5)
ggmap(houston, base_layer = ggplot(data=murders, aes(x=lon, y=lat)))+geom_point(color="red", size=3, alpha=0.5)
ggplot
data(carData)
data('carData')
data("cars")
str(crime)
data('Salaries')
data('salary')
data(iris)
data(carData)
library(carData)
str(crime)
data('Salaries')
str(cardata)
str(crime)
str(Salaries)
str(crime)
library(tmaptools)
library(ggmap)
library(ggplot2)
str(Crime)
data(crime)
str(crime)
table(crime$day, crime$hour)
daycount=as.data.frame(table(crime$day, crime$hour))
head(daycount)
str(daycount)
factor(daycount)
strat.hist()
library(Rstat)
strat.hist()
ch2.man()
strat.hist(s=1:3*0.5)
start.hist(ng=4, m=2:5*3)
strat.hist(ng=4, m=2:5*3)
data("exa2_3")
x = exa2_3
str(x)
x = as.matrix(x)
str(x)
stem(x)
stem(x,2)
data("exa2_3")
x=exa2_3
x
str(x)
x1 = as.matrix(x)
x1
str(x1)
stem(X1)
stem(x1)
stem(x)
x = as.numeric(exa2_3)
x = as.matrix(
"exa2_3")
stem(x)
x = as.matrix(exa2_3)
stem(x)
stem(x,2)
boxplot(x)
boxplot(x)
library(Rstat)
boxplot(x)
boxplot(x)
boxplot(exa2_3)
boxplot(exa2_3)
boxplot(x)
x2 = matrix(x,ncol=1)
boxplot(x2)
boxplot(x2, horizontal = T)
boxplot(x2, horizontal = T, main='box plot', col='cyan')
x2
x
x3 = matrix(x, ncol=2)
x3
boxplot(x2, horizontal=T, main="box plot", col='cyan')
points(x2, rep(1,100))
points(x2, rep(0.5,100))
points(x2, rep(2,100))
points(x2, rep(1.5,100))
boxplot(x2, horizontal=T, main="box plot", col='cyan')
points(x2, rep(1,100))
xfn=fivenum(x2)
xfn
text(xfn, 0.7, labels=xfn)
text(xfn, 1.5, labels=xfn)
legend("topright", paste0(c("Mean","stdev","size"),"=", round(c(mean(x2),sd(x2),length(x2),4), text.col=4)))
legend("topright", paste0(c("Mean","stdev","size"),"=", round(c(mean(x2),sd(x2),length(x2)),4)), text.col=4)))
legend("topright", paste0(c("Mean","stdev","size"),"=", round(c(mean(x2),sd(x2),length(x2)),4)), text.col=4)))
legend("topright", paste0(c("Mean","stdev","size"),"=", round(c(mean(x2),sd(x2),length(x2)),4)), text.col=4)
legend("topright", paste0(c("Mean","stdev","size"),"=", round(c(mean(x2),sd(x2),length(x2)),4)), text.col=4)
str(x)
boxplot(x, main='boxplot', col='cyan')
boxplot(x, main='boxplot', col='cyan', boxwex=0.4, col=7)
boxplot(x, main='boxplot',  boxwex=0.4, col=7)
points(x, req(1, 100))
points(x, rep(1, 100))
points(x, rep(0.5, 100))
points(x, rep(0.5, 10))
points(x, rep(0.1, 100))
points(x, rep(2, 100))
grid(col=3)
points(x, rep(1:10, each=10), pch=19, cex=0.8, col=2)
boxplot(x, main='boxplot',  boxwex=0.4, col=7)
grid(col=3)
points(x, rep(1:10, each=10), pch=19, cex=0.8, col=2)
points(rep(1:10, each=10), x, pch=19, cex=0.8, col=2)
xstat=apply(x, 2, fivenum)
xstat
text(rep(1:10,each=5), xstat, labels=xstat, cex=0.8, col=4, pos=4)
corr.plot6()
ch2.man(4)
corr.plot6(m1=50,m2=65, s2=5, r=0.8, r2=0.9, n=100)
str(mtcars)
d=mtcars
plot(x=d$wt, y=d$mpg)
scat.lm(d$st, d$mpg)
scat.lm(d$wt, d$mpg)
library(Rstat)
scat.lm(d$wt, d$mpg)
with(d, scat.lm((wt,mpg))
with(d, scat.lm(wt,mpg))
pairs(d[c(1,2,4,6)])
plot(d[c(1,2,4,6)])
mf = ~mpg+cyl+hp+wt
pairs(mf, data=d)
mpg
myp = function(x,y) {points(x,y,pch=19,col=4)}
myp = function(x,y) {points(x,y,pch=19,col=4)
abline(lm(y~x), col=2) }
pairs(mf, data=d, main='s-p', panel=myp)
pairs(d[c(1,2,4,6)])
pairs(mf, data=d)
str(x)
data("exa2_3")
x=exa2_3
str(x)
x = as.matrix(x)
x
str(x)
location.est(x)
location.est(x, detail=T)
table(x)
max(table(x))
max(table(x))[0
]
max(table(x))
max(table(x))[6]
max(table(x))[0]
max(table(x)).print
max(table(x)).col
max(x)
max(table(x))
table(x)[0]
str(table(x))
table(x)[1]
table(x)[max(table(x))]
table(x)[max(table(x))[1]]
max(table(x))
max(table(x))[1]
max(table(x))[0]
max(table(x))$[1]
max(table(x))
as.numeric(max(table(x)))
table(x)[1]
max(table(x))
table(x)
str(table(x))
which(x>=6)
as.data.frame(table(x))
x1=as.data.frame(table(x))
x1[1]
x1[2]
x1[2] == 6
spread.ext(x, detail=T)
spread.est(x, detail=T)
x
x1=as.matrix(x)
spread.est(x1, detail=T)
sum(x^2)
fivenum(x)
summary*x
summary(x)
summary(x2)
quantile(x, p=0.25)
names(x)
x
class(x)
ls()
names(iris)
length(iris)
length(iris$Sepal.Length)
str(iris)
class(iris)
names(iris)
length(iris)
length(iris$Sepal.Width)
x=1:7; length(x)
x
names(x) = LETTERS[1:7]
names(x)
y=3:7
c(x,y)
cbind(x,y)
rbind(x,y)
x
x=1:10; y=
dfg
x=1:10; y=11:20; z=21:30
cbind(x,y,z)
c(x,y,z)
rbind(x,y,z)
ls()
rm(x,y)
1:10
seq(1:10, by=2)
seq(1,10,by=2)
seq(1,5.5,length=10)
seq(1,5.5,length=9)
rep(1:3, 4)
rep(1:3, each=4)
set.seed(1234)
x=rnorm(100)
x
t = cut(x, -5:5)
t
table(t)
plot(table(t))
x=c(5,1,34,4)
sort(x)
sort(x, decreasing = T)
order(x)
library(gplots)
library(animation)
library(rstat)
library(Rstat)
ami.potions(nmax=1000, interaval=0.01)
ani.potions(nmax=1000, interaval=0.01)
ani.options(nmax=1000, interaval=0.01)
win.grapg(7,4)
win.graph(7,4)
myf = function(n,mu) rbinom(n,size=1,prob=mu)
lln.ani(FUN=myf, mu=0.5, type="n")
rbinom(n=2, size=1, prob=0.5)
rbinom(n=5, size=1, prob=0.5)
S = tosscoin(4)
library(prob)
S = tosscoin(4)
S = S[order(S$toss1,S$toss2,S$toss3,S$toss4)]
S = S[order(S$toss1,S$toss2,S$toss3,S$toss4),]
counth =function(x) sum(x==="H")
counth =function(x) sum(X==="H")
counth =function(x) {sum(X==="H")}
counth =function(x) {sum(x==="H")}
counth=function(x) sum(x=="H")
counth=function(x) {sum(x=="H")}
S
A = subset(S, apply(S,counth)>=2)
A = subset(S, apply(S,1,counth)>=2)
element(A)
pprt(A,nrow(S))
myf = function(n,k){
S = tosscoin(n)
A = subset(S, apply(S,1,counth)>=k)
pprt(A,nrow(S))
}
myf(4,2)
for ( k in 1:10){ myf(2*k,k)}
S = rolldie(4)
S
S = rolldie(4)
A = subset(S, (X1+X2+X3+X4)>=15)
pprt(A,nrow(s))
pprt(A,nrow(S))
A = subset(S, apply(S,1, sum)>=15) ; pprt(A,nrow(S))
B = subset(S, apply(S,1, max)==6) ; pprt(B,nrow(S))
C = subset(S, apply(S,1, min)==1) ; pprt(C,nrow(S))
AB = intersect(AB);pprt(AB,nrow(S))
AB = intersect(A,B);pprt(AB,nrow(S))
AC = intersect(A,C);pprt(AC,nrow(S))
AV=rownames(A)
AV
A
AV=rownames(A)
BV=rownames(B)
CV=rownames(C)
venn(list(AV,BV,CV), showSet=T)
venn(list(AV,BV,CV), showSet=T)
x=matrix(1:15,3,5)
rownames(x) = letters[1:3]
colnames(x) = paste0("c",1:5)
x
x[,4]
x[4]
x[3,1]
x[4,]
x['c1']
x[c1]
x[,"c1"]
x[-c(1,3),]
x[c("a","c"),]
x[c("a","c"),2:5]
x[c("a","c"),c(2:5)]
c1=letters[1:20]
c2=1:20
c3=(1:20 %%3)==0
c3
df1 = data.frame(c1,c2,c3)
str)df1
str(df1)
names(df1) = c("요인","숫자","논리")
str(df1)
df1[1:5,]
df1['요인']
df1[,2]
df1['숫자']
[df1['숫자']]
df1[['숫자']]
mead(df1$숫자)
mean(df1$숫자)
mead(df1[[2]])
mean(df1[[2]])
ls()
> x=rnorm(100)
> t = cut(x, -5:5) : x를 –5부터5사이에 할당해라
> x=rnorm(100)
> t = cut(x, -5:5)
x=rnorm(100);t = cut(x, -5:5)
ls()
myl=list(c1,c2,c3,df1,t,x)
rm(c1,c2,c3,df1,t,x)
ls()
myl$x
myl[5]
myl[6]
myl[[6]]
myl[6]
x=data.frame(ID=1:4, Age=c(37,49,46,78),Class=c("A","B","B","A"))
y=data.frame(ID=4:1, Name=c("John","Tom","Mary","Candy"),BT=c("A","B","A","O"))
x
y
cbind(x,y)
merge(x,y,by="ID")
aggregate(x$Age,by=list(X$Class),FUN=mean)
x
aggregate(x$Age,by=list(x$Class),FUN=mean)
# 사용할 패키지 추가
library(ggplot2)
# 사용할 패키지 추가
library(ggplot2)
library(tidyr)
# 사용할 패키지 추가
library(ggplot2)
library(tidyr)
library(dplyr)
library(ggthemes)
library(ggmap)
library(ggmap)
library(class)
library(caret)
Bank = read.csv('CommonBank.csv', stringsAsFactors=FALSE)
#id와 zip.code삭제
Bank = subset(Bank, select=-c(ID, ZIP.Code))
Bank$PersonalLoan = factor(Bank$PersonalLoan, levels=c(1,0), labels=c("가입","미가입"))
#라벨링할 칼럼 삭제
Bank_n = subset(Bank, select=-c(PersonalLoan))
#라벨링 칼럼 생성
Bank_l = subset(Bank, select=c(PersonalLoan))
#z_normalize-1
z_normalize = function(x){
+ return ((x-mean(x))/sd(x))}
#z_normalize를 적용하여 데이터프레이으로 변환
bank_z=as.data.frame(lapply(Bank_n[1:11], z_normalize))
#train, test dataset 분리
Bank_train = bank_z[1:4000,]
Bank_test = bank_z[4001:5000,]
Bank_train_labels = Bank_l[1:4000,]
Bank_test_labels =Bank_l[4001:5000,]
#training dataset target variable 분포
Bank_train_labelsv = as.data.frame(Bank_l[1:4000,])
names(Bank_train_labelsv)=c("PersonalLoan")
plotdata = count(Bank_train_labelsv, PersonalLoan)
ggplot(plotdata, aes(x=PersonalLoan, y=n))+geom_bar(stat="identity")+labs(x="사품가입/미가입자수",y="count",title="train데이터 셋 상품 가입/미가입 현황")+geom_text(aes(label=n),vjust=-0.5)
#test dataset target variable 분포
Bank_test_labelsv= as.data.frame(Bank_l[4001:5000,])
names(Bank_test_labelsv)=c("PersonalLoan")
plotdata = count(Bank_test_labelsv, PersonalLoan)
ggplot(plotdata, aes(x=PersonalLoan, y=n))+geom_bar(stat="identity")+labs(x="사품가입/미가입자수",y="count",title="test데이터 셋 상품 가입/미가입 현황")+geom_text(aes(label=n),vjust=-0.5)
#validation set을 포함하여 데이터 re-split
Bank_train3 = bank_z[1:3200,]
Bank_test3 = bank_z[4001:5000,]
validation_set3 = bank_z[3201:4000,]
Bank_train_labels3 = Bank_l[1:3200,]
Bank_test_labels3 =Bank_l[4001:5000,]
validation_set_labels3 = Bank_l[3201:4000,]
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 5)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 5)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#95
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 5)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 7)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 9)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 9)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#94
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 7)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#94
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 9)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 11)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 13)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 13)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#93.62
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 13)
#93.62
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 13)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 15)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#95
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 5)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#94.38
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 7)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#94.62
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 9)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#93.88
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 11)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#93.62
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 13)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#93.5
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 15)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 17)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 19)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 3)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
#93.62
Bank_test_pred3 <- knn(train = Bank_train3, test = validation_set3, cl = Bank_train_labels3, k = 57)
confusionMatrix(Bank_test_pred3, validation_set_labels3)
Bank = read.csv('CommonBank.csv', stringsAsFactors=FALSE)
#id와 zip.code삭제
Bank = subset(Bank, select=-c(ID, ZIP.Code))
Bank$PersonalLoan = factor(Bank$PersonalLoan, levels=c(1,0), labels=c("가입","미가입"))
#라벨링할 칼럼 삭제
Bank_n = subset(Bank, select=-c(PersonalLoan))
#라벨링 칼럼 생성
Bank_l = subset(Bank, select=c(PersonalLoan))
#z_normalize를 적용하여 데이터프레이으로 변환
bank_z=as.data.frame(lapply(Bank_n[1:11], z_normalize))
str(Bank_m)
str(Bank_n)
str(Bank_l)
Bank_train = Bank_n[1:4000,]
Bank_test = Bank_n[4001:5000,]
Bank_train_label = Bank_l[1:4000,]
Bank_test_labels = Bank_l[4001:5000,]
str(Bank_train)
str(Bank_test)
str(Bank_train_label)
str(Bank_train_label)
Bank_train_labels = Bank_l[1:4000,]
Bank_test_labels = Bank_l[4001:5000,]
str(Bank_train_labels)
str(Bank_test_labels)
Bank = read.csv('CommonBank.csv', stringsAsFactors=FALSE)
#id와 zip.code삭제
Bank = subset(Bank, select=-c(ID, ZIP.Code))
Bank$PersonalLoan = factor(Bank$PersonalLoan, levels=c(1,0), labels=c("가입","미가입"))
str(Bank)
Bank_train = Bank[1:4000,]
Bank_test = Bank[4001:5000,]
Bank_train_labels = Bank[1:4000,8]
Bank_test_labels = Bank[4001:5000,8]
str(Bank_train_labels)
Bank_train = Bank[1:4000,]
Bank_test = Bank[4001:5000,]
Bank_train_labels4 = Bank[1:4000,8]
Bank_test_labels4 = Bank[4001:5000,8]
str(Bank_train_labels4)
z_normalized <- c("center", "scale")
cv <- trainControl(method="repeatedcv", number = 5, repeats = 5)
tune_grid <- expand.grid(k = seq(1, 99, 2))
knn_fit = train(data=Bank_train, PersonalLoan~.,method="knn", trControl=cv,preProcess=z_normalized,tuneGrid=tune_grid )
knn_fit
ggplot(knn_fit)+theme_bw()
#최종 모델에 test set 적용
test_pred = predict(knn_fit, Bank_test)
#최종 모델에 test set 적용
test_pred = predict(knn_fit, Bank_test)
confusionMatrix(test_pred, Bank_test_labels4)
getwd()
setwd("C:/Users/seook/Documents/21-1데이터분석및활용(R)")
